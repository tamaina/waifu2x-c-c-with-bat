# waifu2x-c/c with bat and HTA-GUI

waifu2x-converter-cppは早いけど、コマンドプロンプトへの入力が煩わしいし、フロントエンドは更新されない・・・。そもそもフォルダの処理に対応してない・・・。

caffeはGUIがあるけれど、遅いし、ファイルの一括処理が面倒・・・。

かといって速い本家( http://waifu2x.udp.jp/ )やw2x-multi( http://waifu2x.me/ )などのwebサービスを利用すると、ダウンロードをする手間が煩わしい。

自分でAWSで構築するのは抵抗があるし・・・

そんなあなたに、このバッチファイルやHTAのフロントエンドはいかがですか。

## 概要

- batフォルダ内に一括変換に便利なバッチファイルとHTAのGUIフロントエンドが入っています。
- waifu2xのtanakamura氏版cppバージョンとlltcggie氏版caffeバージョンが入っています。
- 本体は、最新版が出たらなるべく早く入れ替えます。
- gitに不慣れなためすべてのファイルが新規になっています。ご了承ください。
- I'm sorry, but I won't make English version.

## できること

**簡単な機能しかないconverter-cppでも以下のことができます。**

### batchファイル/HTAで可能にしたこと

- 設定は**バッチファイルを書き換えるだけ**です。
    - 変えるときは、少し面倒くさいかも？
    - でも、自分の好みの設定があれば使用時の設定が不要です。
- **ドラッグアンドドロップ**で一発処理できます。
- **複数ファイル**の処理に対応しています。
- **フォルダとファイルを混ぜて**処理できます。
    - **再帰的**にフォルダ内を変換できます(設定でon/off可)。
- **実行時間**を表示します。
    - ファイルごとにかかった時間とバッチファイルを起動していた時間両方を記録します。
- **フォルダに一括出力**できます。
    - 出力方法が2パターンあります。
    - さまざまな圧縮フォルダに出力できます。
- 処理の経過をまとめた**ログファイル**が作成されます。
- **自動倍率設定**ができます。
    - 縦/横の大きさの目標値(px)を設定して、それを満たす倍率を自動で設定します。
    - ちなみに、2の累乗倍でwaifu2xで変換してから、ImageMagickを使用して目標値に縮小しています。
- 処理終了時に**音(wavファイル)が鳴ります**。
- **Twitter**に投稿するのに最適な画像を作成できます。

#### caffeにあってconverterにない機能
- **入力するファイルの拡張子**の変更ができます。
- **出力するファイルの拡張子**の指定が可能です。
- **auto_mode**が使用可能です。
    - auto_mode:jpeg形式のファイルのみノイズ除去を行うモード。
- **alpha情報**がwaifu2xで拡大できます。
    - webサービスよりにじみが少ないように思われます。
- **どのような拡大率を指定しても必ず2の倍数の拡大率でwaifu2xします。**
    - その後ImageMagickを使って縮小します。

### HTAの機能
- ドラッグアンドドロップ

#### webサービスを真似した機能
- superモードが利用できます。
- 圧縮ファイルが作れるようになりました。

## 当セット導入方法
https://github.com/tamaina/waifu2x-c-c-with-bat/releases
こちらのURLからどうぞ

### ImageMagickを導入してください。
ver3.0.0からImageMagickが必須になりました。

1. http://www.imagemagick.org/script/binary-releases.php#windows からダウンロードします。
    - 64bit版→ ImageMagick-[バージョン]-Q16-x64-dll.exe
    - 32bit版→ ImageMagick-[バージョン]-Q16-x86-dll.exe
2. ダウンロードしたのはインストーラなので、指示に従ってインストールします。
    - このとき、チェックボックスがたくさんある画面で**上から二番目と一番下**がオンになるようにしてください。
3. 引き続きインストーラに従ってインストールします。完了したらとりあえずつかってみましょう。

## とりあえず使ってみる
GitHubからダウンロードしたフォルダの中の**bat**というフォルダを見つけてください。

waifu2x-GUI.htaを開いてください。画面が表示されます。

とりあえず下の[ここにファイル/フォルダーをドロップ]に画像をドラッグアンドドロップします。

黒いコマンドプロンプトの画面が表示されて、自動的に処理が開始されるはずです。

処理が終わったらその旨が表示されます。

で

画像の入っていたフォルダに"waifued"というフォルダがあるので、開きます。

その中に、変換されたファイルが入っています。

## 詳しい使い方
### バッチファイルの使い方
howtouse.mdを御覧ください。

### HTA-GUIの使い方
画面の指示に従えばいいと思います。

----

## 現状と今後
### 既知のバグ
- 半角の！(エクスクラメーション)を含んだファイル名のファイルが取得できない

- その他バグがあったらissueか2chのw2xスレかtwitter@tamaina_simuに報告してください。

### 機能追加予定
- さいごにiccプロファイルをimagemagickで追加する
- さいごに任意の拡張子に変更できるようにする

## license
LICENSE.mdを参照してください。
    
##さいごに

waifu2xの発展に携わったすべての方々に感謝させていただきます。
またbatchファイルやhtaの書き方はたくさんのサイトを参考にしました。

----

# おまけ

#### 使い方
- waifu2xのbatのようにドラッグアンドドロップしてください。
**注:おまけなのでフォルダをドラッグアンドドロップしても変換しません**

## twittermode

本体にあったtwittermodeだけを抜粋したものです・・・というか本体の機能自体このbatを使って動いています。
ImageMagickが必要です。

- 左上1ドットを少しだけ透明にして、twitterに載せたときjpegになるのを防ぎます。
- 3MBを上回った場合、pngquantで軽量化します。
  - すこし減色されますが、jpegのようなノイズが出てくるわけではありません。

## 画像ファイルcmyk-rgb変換bat

bat\omake CMYK-RGBフォルダに入っています。
ImageMagickでrgbからcmykに変換するのが案外うまくいかなかったので公開。

###初期設定
1. (ImageMagickと)**exiftool**を導入してください。(申し訳ないですが、導入方法やURLはググってください)
導入する際に、両方の実行ファイルがあるフォルダにパスを通してください。
    * ExifToolは、名前をexiftool.exeに改名してください。
2. JapanColor2011Coated.iccをダウンロードします。
    * http://japancolor.jp/icc.html **規約をよく読もう！**
3. JapanColor2011Coated.iccを右クリックメニューからインストール
    * 解凍しないと出てこないかも

