<!DOCTYPE html>
<html><head>
<meta http-equiv="x-ua-compatible" content="IE=10">
<hta:application id="HtaObj" icon="waifu2x.ico" SINGLEINSTANCE="yes" sysmenu="none" aplicationname="waifu2x-GUI"/>
<style>
body         {
              color:#FFFFFF;
              background-color:#444448;
              font-weight:normal,400;
              font-family:"Meiryo","Gen Shin Gothic","GenEi Gothic","Source Han Sans",sans-serif;
              margin-left:7%;
              margin-right:7%;
              position:relative;
              scrollbar-base-color:#171b1f;
              scrollbar-track-color:#343638;
              scrollbar-arrow-color:#FFFFFF;
             }
input        {
              font-weight:bold,medium,normal;
              font-family:"Meiryo","Gen Shin Gothic","Gen Ei Gothic",sans-serif;
             }
[type="text"],[type="number"] {
              border:solid 2px black;
             }
select       {
              font-family:"Meiryo","Gen Shin Gothic","Gen Ei Gothic",sans-serif;
              border:solid 2px black;
             }
h1           {
              font-family:"Segoe UI","Yu Gothic","Gen Shin Gothic","Gen Ei Gothic","Meiryo",sans-serif;
              font-weight:900;
              color: #000;
              text-shadow:0px -0.5px 5px #fff,0px 0px 5px #fff,0px -0.5px 5px #fff,0px 0px 5px #fff,0px -0.5px 5px #fff;
              margin-left:5px;
              font-size:36pt;
             }
th           {
              text-align:right;
              font-weight:normal;
             }
fieldset     {
              padding:16px;
              height:100%;
              margin-bottom:5px;
              border:solid 1px #494b4f;
              background-color:#222426;
             }
legend       {
              margin-left:-17px;
              margin-bottom:0px;
              width:100px;
              background-color:#171b1f;
              border:solid 1px #484b4f;
              font-weight:normal;
              padding-left:30px;
              padding-right:30px;
              padding-top:6px;
              padding-bottom:6px;
             }
table        {
              width:100%;
             }
td           {
              width:50%;
             }
p            {
              margin:10px;
             }
.rightcontent{
              float:right;
              width:49%;
              margin-left:1px;
             }
.left_content{
              float:left;
              width:49%;
              margin-right:1px;
             }
Button       {
              font-weight:medium;
              font-family:"Meiryo","Gen Shin Gothic","Gen Ei Gothic",sans-serif;
              background:#7690a3;
              border-top:1px solid #DDD;
              border-left:1px solid #DDD;
              border-right:1px solid #BBB;
              border-bottom:1px solid #BBB;
              color:#FFFFFF;
              width: 50%;
              text-shadow: 0 0 4px #000, 0 0 4px #000, 0 0 4px #000;
              }
div          {
              margin:0px;
              padding:0px;
             }
</style>
<script type='text/JavaScript'><!--
function firstread(){

var s           = "\ ";
var fs          = new ActiveXObject( "Scripting.FileSystemObject" );
var myCD        = fs.GetFolder(".").Path;
var outsetting  = myCD + "\\script\\setting.ini";
try{
var file        = fs.OpenTextFile( outsetting , 1, false, -2 );
}catch(e){
 var newsetfile = fs.OpenTextFile( outsetting , 2 , true );
 newsetfile.Close();
 return ;
}
var text        = file.ReadAll();

var splited     = text.split( " " );

var form = document.SettingForm;

// mode01 model01 scaleauto scaleauto_width01 scaleauto_height01 scale_ratio01 noise_level01 inexli01 subf01 usewaifu folderoutmode outfoldernameset compformat endwav twittermode alphaswitch otheropca01 otheropco01 otherop7z01;


document.getElementById(splited[0]).checked = true;
form.model01.value                          = splited[1];
if ( splited[2] == "true" ) {
form.scaleauto_check.checked                = true;
} else {
form.scaleauto_check.checked                = false;
}
form.scaleauto_width.value                  = splited[3];
form.scaleauto_height.value                 = splited[4];
form.scale_ratio01.value                    = splited[5];
if ( splited[6] == "super" ) {
form.noise_level01.value                    = 3;
} else {
form.noise_level01.value                    = splited[6];
}
alldisable("inexli01");
var exts = splited[7].split( ":" );
for( i=0; i<exts.length; i++ ) {
document.getElementById( exts[i] ).checked = true;
}

if ( splited[8] == "true" ) {
form.subf01.checked = true;
} else {
form.subf01.checked = false;
}
if ( splited[9] == "auto" ) {
form.usewaifu_autoswitch.checked = true;
} else {
form.usewaifu_autoswitch.checked = false;
document.getElementById( splited[9] ).checked         = true;
}
form.folderoutmode[ splited[10] ].checked                = true;
form.outfoldernameset.value                            = splited[11];
form.compformat.value                                  = splited[12];
if ( splited[14] == "true" ) {
form.twittermode.checked = true;
} else {
form.twittermode.checked = false;
}
if ( splited[15] == "true" ) {
form.alphaswitch.checked = true;
} else {
form.alphaswitch.checked = false;
}
form.OutputExtension.value                             = splited[16];
if ( splited[16] == "false" ) {
form.OutputExtension.value = "" ;
}
form.otheropca01.value                                 = splited[18].replace( /\"/g , "" ).replace( "△" ," " );
form.otheropco01.value                                 = splited[19].replace( /\"/g , "" ).replace( "△" ," " );
form.otheropsz01.value                                 = splited[20].replace( /\"/g , "" ).replace( "△" ," " );
form.otheropff01.value                                 = splited[21].replace( /\"/g , "" ).replace( "△" ," " );
window.resizeTo( splited[22],splited[23] );
window.moveTo( splited[24],splited[25] );
}
--></script>
<title>waifu2x GUI</title>
<meta http-equiv='content-type' content='text/html; charset=shift_jis'>
<!-- 参考→http://mimizun.com/log/2ch/tech/1124559962/833 -->
</head>

<body>


<h1>waifu2x GUI</h1>
<form name="SettingForm" id="SettingForm">

<!--

　　雛形
<div name="left_content" class="left_content">
<fieldset>
<legend> </legend>


<label><input type=" " name=" " value=" " id=" " checked="checked"> </label>

</fieldset>
</div>
-->
<div name="left_content" class="left_content">
<fieldset>

<legend>使用するwaifu2x</legend>
<label><input type="checkbox" name="usewaifu_autoswitch" id="usewaifu_autoswitch" onchange="w2xautochange();" />自動設定</label>

<p>
<label id="usewaifu_labela"><input type="radio" name="usewaifu" value="waifu2x-converter" id="waifu2x-converter" checked="checked">waifu2x-converter-cpp</label>
</p><p>
<label id="usewaifu_labelb"><input type="radio" name="usewaifu" value="waifu2x-caffe-cui" id="waifu2x-caffe-cui">waifu2x-caffe</label>
</p>
</fieldset>
</div>

<div name="rightcontent" class="rightcontent">
<fieldset>
<legend>動作モード</legend>
<p>
<label><input type="radio" name="mode01" value="auto_scale" id="auto_scale" checked="checked" onchange="modeselect01();">jpeg以外でノイズ除去を行わない</label>
</p><p>
<label><input type="radio" name="mode01" value="noise_scale" id="noise_scale" onchange="modeselect01();">すべての画像に拡大とノイズ除去</label>
</p><p>
<label><input type="radio" name="mode01" value="scale" id="scale" onchange="modeselect04();">拡大のみ</label>
</p><p>
<label><input type="radio" name="mode01" value="noise" id="noise" onchange="modeselect03();">ノイズ除去のみ</label>
</p>
</fieldset>
</div>

<div name="left_content" class="left_content">
<fieldset name="F_scale_setting" id="F_scale_setting">
<legend>拡大率</legend>
<p>
<label><input type="checkbox" name="scaleauto_check" value="checked" id="scaleauto_check" checked="checked" onclick="scaleautoChanging();">拡大率を自動計算</label>
</p><table>
<tbody id="scaleAutoObj">
<tr><th style="width:25%;">
<label for="scaleauto_width">目標幅:</label></th><td id="td_into"><input type="number" value="1920" name="scaleauto_width" id="scaleauto_width" style="width:70px;">px
</td></tr><tr><th>
<label for="scaleauto_height">目標高さ:</label></th><td id="td_into"><input type="number" value="1080" name="scaleauto_height" id="scaleauto_height" style="width:70px;">px
</td></tr>
</tbody></table>
<hr style="border:solid 0.5px #494b4f;">
<table><tbody id="scaleRatioObj"><tr><th style="width:25%;">
<label for="scale_ratio01">拡大率:</label></th><td id="td_into"><input type="number" value="2" name="scale_ratio01" step="0.0000001" id="scale_ratio01"  style="width:70px;">倍
</td></tr>
</tbody>
</table>
</fieldset>
</div>

<div name="rightcontent" class="rightcontent">
<fieldset name="F_noise_setting" id="F_noise_setting">
<legend>ノイズ除去レベル</legend>
<label>Lv. <span id="noiselevelvalue"></span>
<br/><input type="range" name="noise_level01" id="noise_level01" max="3" min="1" onchange="noiselevelrange();" style="width:30%;height:14px;"></label>
</fieldset>
</div>

<div name="rightcontent" class="rightcontent">
<fieldset>
<legend>使用するモデル</legend>
<p name="F_model_setting" id="F_model_setting">
モデルを選択：<br>
<select name="model01" id="model01" style="width:100%;">
<option value="anime_style_art_rgb" selected>アニメ・イラスト[anime_style_art_rgb]</option>
<option value="photo">写真[photo]</option>
<option value="anime_style_art">アニメ・イラスト(輝度のみ)[anime_style_art]</option>
</select>
</p>
</fieldset>
</div>

<div name="left_content" class="left_content">
<fieldset>
<legend>変換する画像の拡張子</legend>
<button type="button" onclick="allcheck(inexli01);" >全選択</button><button type="button" onclick="alldisable(inexli01);" >全解除</button>
<table><tbody>
<tr><td>
<label><input type="checkbox" name="inexli01" value="jpg" id="jpg" checked="checked">jpg</label></td><td>
<label><input type="checkbox" name="inexli01" value="jpeg" id="jpeg" checked="checked">jpeg</label>
</td></tr>
<tr><td>
<label><input type="checkbox" name="inexli01" value="png" id="png" checked="checked">png</label></td><td>
<label><input type="checkbox" name="inexli01" value="bmp" id="bmp" checked="checked">bmp</label>
</td></tr>
<tr><td>
<label><input type="checkbox" name="inexli01" value="tif" id="tif" checked="checked">tif</label></td><td>
<label><input type="checkbox" name="inexli01" value="tiff" id="tiff" checked="checked">tiff</label>
</td></tr>
<tr><td>
<label><input type="checkbox" name="inexli01" value="tga" id="tga" checked="checked">tga</label></td><td>
<label><input type="checkbox" name="inexli01" value="gif" id="gif" checked="checked">gif</label>
</td></tr>
</tbody></table>
<hr style="border:solid 0.5px #494b4f;">
<table><tbody>
<tr><td>
<label><input type="checkbox" name="inexli01" value="mp4" id="mp4" checked="checked">mp4</label></td><td>
<label><input type="checkbox" name="inexli01" value="avi" id="avi" checked="checked">avi</label>
</td></tr>
<tr><td>
<label><input type="checkbox" name="inexli01" value="wmv" id="wmv" checked="checked">wmv</label></td><td>
<!--<label><input type="checkbox" name="inexli01" value="avi" id="avi" checked="checked">avi</label>-->
</td></tr>
</tbody></table>
</fieldset>
</div>

<div name="rightcontent" class="rightcontent">
<fieldset>
<legend>フォルダ入力設定</legend>
<p>
<label><input type="checkbox" name="subf01" id="subf01" checked="checked">サブフォルダの画像も処理<br>(再帰的に処理する)</label>
</p>
</fieldset>
</div>

<div name="rightcontent" class="rightcontent">
<fieldset>
<legend>出力拡張子</legend>
<p><label><input type="checkbox" name="extension_switch" id="extension_switch" onchange="extechange();">出力した画像の拡張子を統一する</label></p>
<input type="text" name="OutputExtension" value="png" id="OutputExtension" style="width:50px;">
</fieldset>
</div>

<div name="left_content" class="left_content">
<fieldset>
<legend>終了時の処理</legend>

<p><label><input type="checkbox" name="alarm_switch" id="alarm_switch" onchange="alarmchange();">終了時に音を鳴らす</label></p>
<label><input type="file" name="alarmfile" id="alarmfile" accept="audio/wav" style="width:100%;"></label></p>
<p><label><input type="checkbox" name="icc_switch" id="icc_switch" onchange="iccchange();">ICCプロファイルを付与する</label></p>
<label><input type="file" name="IccProf" id="IccProf" accept=".icc" style="width:100%;"></label></p>

<p><label><input type="checkbox" name="twittermode" id="twittermode">twitter投稿用に最適化する</label></p>
<p><label><input type="checkbox" name="alphaswitch" id="alphaswitch" checked="checked">alpha情報をバッチファイルで処理する</label></p>

</fieldset>
</div>


<div name="rightcontent" class="left_content">
<fieldset>
<legend>フォルダ出力設定</legend>
<p>
<label><input type="radio" name="folderoutmode" value="0" id="0" onchange="FoldermodeChanging();">入力フォルダと同じフォルダ</label>
</p><p>
<label><input type="radio" name="folderoutmode" value="1" id="1" onchange="FoldermodeChanging();">フォルダに出力(分割する)</label>
</p><p>
<label><input type="radio" name="folderoutmode" value="2" id="2" onchange="FoldermodeChanging();" checked="checked">フォルダに出力(一括する)</label>
</p><p>
<label><input type="radio" name="folderoutmode" value="3" id="3" onchange="FoldermodeChanging();">圧縮フォルダに出力</label>
</p>
<table><tbody><tr><th>
<label id="outfolder" for="outfoldernameset">出力フォルダ名：</label></th><td><input type="text" name="outfoldernameset" id="outfoldernameset" value="waifued" style="width:70px">
</td></tr><tr><th>
<label id="outzip" for="compformat">圧縮形式：</label></th><td><select name="compformat" id="compformat" style="width:70px">
<option value="7z">7z</option>
<option value="zip" selected>zip</option>
<option value="xz">xz</option>
<option value="bzip2">bzip2</option>
<option value="gzip">gzip</option>
<option value="tar">tar</option>
<option value="wim">wim</option>
</select>
</td></tr></tbody></table>
</fieldset>
</div>
<div style="clear:both;">
<fieldset>
<legend>付加オプション</legend>
<p>その他のオプションです。(例 : --tta 1 )</p>
<table><tbody>
<tr><th><label for="otheropco01">converter-cpp:</label></th><td style="width:75%;"><input type="text" name="otheropco01" id="otheropco01" style="width:100%;"></td></tr>
<tr><th><label for="otheropco01">caffe:</label></th><td style="width:75%;"><input type="text" name="otheropca01" id="otheropca01" style="width:100%;"></td></tr>
<tr><th><label for="otheropsz01">7-zip:</label></th><td style="width:75%;"><input type="text" name="otheropsz01" id="otheropsz01" style="width:100%;"></td></tr>
<tr><th><label for="otheropff01">ffmpeg:</label></th><td style="width:75%;"><input type="text" name="otheropff01" id="otheropff01" style="width:100%;"></td></tr>
</tbody></table>
</fieldset>
</div>
<div style="clear:both;">
<p>参考……</p>
<p>システム音のフォルダは C:\Windows\Media です。<br>iccの場所はC:\Windows\System32\spool\drivers\colorです。<br>HTAとIEの仕様により、次回起動時にファイル名は保持されません。</p>
<p></p>
<p>透過情報付きアニメーションGIFはalpha情報をバッチファイルで処理します。</p>
</div>
</form>
<object id='ddObj' classid='CLSID:8E3867A3-8586-11D1-B16A-00C0F0283628'
 style='text-align:center;text-size:200%;margin-left:-7%;top:85vh;height:15vh;display:block;position:fixed;width:100%;border-top:ridge 7px #000000;background-color:#000000;'>
<param name='OLEDropMode' value='1'>
<param name='Style' value='1'>
<param name='Simpletext' value='ここにファイルをドラッグアンドドロップすると変換が始まります。'>
</object>

<div style="padding-top:15vh;">
<p> </p>
</div>

<script type='text/JavaScript'><!--
var form = document.SettingForm;

function windowresize(){
var thewidth               = document.body.clientWidth;
var leftcontent            = document.getElementsByName('left_content');
var rightcontent           = document.getElementsByName('rightcontent');
var fieldsets              = document.getElementsByTagName('fieldset');
var legends                = document.getElementsByTagName('legend');

if ( thewidth >= 651 ){
document.body.style.margin = "0% 7%";
for(i=0;i<rightcontent.length;i++){
rightcontent[i].style.Float = "right";
rightcontent[i].style.clear = "none";
rightcontent[i].style.width = "49%";
rightcontent[i].style.margin = "0px 0px 0px 0px";
}
for(i=0;i<leftcontent.length;i++){
leftcontent[i].style.Float = "left";
leftcontent[i].style.clear = "none";
leftcontent[i].style.width = "49%";
leftcontent[i].style.margin = "0px 0px 0px 0px";
}
for(i=0;i<legends.length;i++){
var setwidth = fieldsets[i].clientWidth -60;
try{
legends[i].style.width = setwidth + "px" ;
}catch(e){
void 0;
}
}
} else {
document.body.style.margin = "0% 7%";
for(i=0;i<rightcontent.length;i++){
rightcontent[i].style.float = "none";
rightcontent[i].style.clear = "left";
rightcontent[i].style.width = "100%";
rightcontent[i].style.margin = "0px";
}
for(i=0;i<leftcontent.length;i++){
leftcontent[i].style.float = "none";
leftcontent[i].style.clear = "right";
leftcontent[i].style.width = "100%" ;
leftcontent[i].style.margin = "0px";
}
for(i=0;i<legends.length;i++){
var setwidth = fieldsets[i].clientWidth -60;
legends[i].style.width = setwidth + "px" ;
}
}

}

var scaleauto_chkbox       = document.SettingForm.scaleauto_check;
var scaleauto_height       = document.SettingForm.scaleauto_height;
var scaleauto_width        = document.SettingForm.scaleauto_width;
var scale_ratio01          = document.SettingForm.scale_ratio01;
var noiselevelbar          = document.SettingForm.noise_level01

function scaleautoChanging(){

var scaleauto_chkbox       = document.SettingForm.scaleauto_check;

if( scaleauto_chkbox.checked ){
scaleauto_height.disabled  = false;
scaleauto_width.disabled   = false;
scale_ratio01.disabled     = true;
document.getElementById("scaleAutoObj").style.color = "#FFFFFF";
document.getElementById("scaleRatioObj").style.color = "#8899a6";
} else {
scaleauto_height.disabled  = true;
scaleauto_width.disabled   = true;
scale_ratio01.disabled     = false;
document.getElementById("scaleAutoObj").style.color = "#8899a6";
document.getElementById("scaleRatioObj").style.color = "#FFFFFF";
}
}

function noiselevelhoge(){
var noise_level1to3        = document.SettingForm.noise_level01.value;
if ( noise_level1to3 == 1 ){
return "1";
} else if ( noise_level1to3 == 2 ){
return "2";
} else if ( noise_level1to3 == 3 ){
return "super";
}
}

function noiselevelrange(){
var noise_level01 = noiselevelhoge();
document.getElementById("noiselevelvalue").innerHTML = noise_level01;
}

function modeselect01(){

scaleauto_chkbox.disabled  = false;
scaleauto_height.disabled  = false;
scaleauto_width.disabled  = false;
scale_ratio01.disabled  = false;
noiselevelbar.disabled  = false;
scaleautoChanging();

document.getElementById("F_scale_setting").style.color = "#FFFFFF";
scaleautoChanging();
document.getElementById("F_noise_setting").style.color = "#FFFFFF";
}
function modeselect03(){

scaleauto_chkbox.disabled  = true;
scaleauto_height.disabled  = true;
scaleauto_width.disabled  = true;
scale_ratio01.disabled  = true;
noiselevelbar.disabled  = false;
document.getElementById("F_scale_setting").style.color = "#8899a6";
document.getElementById("scaleAutoObj").style.color = "#8899a6";
document.getElementById("scaleRatioObj").style.color = "#8899a6";
document.getElementById("F_noise_setting").style.color = "#FFFFFF";
}
function modeselect04(){

scaleauto_chkbox.disabled  = false;
scaleauto_height.disabled  = false;
scaleauto_width.disabled  = false;
scale_ratio01.disabled  = false;
noiselevelbar.disabled  = true;

document.getElementById("F_scale_setting").style.color = "#FFFFFF";
scaleautoChanging();
document.getElementById("F_noise_setting").style.color = "#8899a6";
}

function modeselect(){
if ( form.mode01[0].checked ){
modeselect01();
} else if ( form.mode01[1].checked ){
modeselect01();
} else if ( form.mode01[2].checked ){
modeselect04();
} else if ( form.mode01[3].checked ){
modeselect03();
}
}
function allcheck(){
for (i=0; i<document.SettingForm.inexli01.length; i++){
    document.SettingForm.inexli01[i].checked = true;
}
}
function alldisable(){
for (i=0; i<document.SettingForm.inexli01.length; i++){
    document.SettingForm.inexli01[i].checked = false;
}
}

function compressable(){
    document.getElementById("outzip").style.Color = "#FFFFFF";
    document.SettingForm.compformat.disabled = false;
}
function compressdisable(){
    document.getElementById("outzip").style.Color = "#8899a6";
    document.SettingForm.compformat.disabled = true;
}
function folderable(){
    document.getElementById("outfolder").style.Color = "#FFFFFF";
    document.SettingForm.outfoldernameset.disabled = false;
}
function folderdisable(){
    document.getElementById("outfolder").style.Color = "#8899a6";
    document.SettingForm.outfoldernameset.disabled = true;
}

function FoldermodeChanging(){
var form = document.SettingForm;
var i = 0;
do {
var folderoutmodetf = form.folderoutmode[i].checked;
var folderoutmode = form.folderoutmode[i].value;
i++;
} while( folderoutmodetf == false );
if ( folderoutmode == 0 ){
folderdisable();compressdisable();
} else if ( folderoutmode == 1 ){
folderable();compressdisable();
} else if ( folderoutmode == 2 ){
folderable();compressdisable();
} else if ( folderoutmode == 3 ){
folderable();compressable();
}
}

function alarmchange(){
if ( document.SettingForm.alarm_switch.checked ){
    document.SettingForm.alarmfile.disabled = false;
} else {
    document.SettingForm.alarmfile.disabled = true;
}
}
function iccchange(){
if ( document.SettingForm.icc_switch.checked ){
    document.SettingForm.IccProf.disabled = false;
} else {
    document.SettingForm.IccProf.disabled = true;
}
}
function extechange(){
if ( document.SettingForm.extension_switch.checked ){
    document.SettingForm.OutputExtension.disabled = false;
} else {
    document.SettingForm.OutputExtension.disabled = true;
}
}

function w2xautochange(){
if ( document.SettingForm.usewaifu_autoswitch.checked ){
    document.SettingForm.usewaifu[0].disabled = true;
    document.SettingForm.usewaifu[1].disabled = true;
    document.getElementById("usewaifu_labela").style.color = "#8899a6";
    document.getElementById("usewaifu_labelb").style.color = "#8899a6";
} else {
    document.SettingForm.usewaifu[0].disabled = false;
    document.SettingForm.usewaifu[1].disabled = false;
    document.getElementById("usewaifu_labela").style.color = "#FFFFFF";
    document.getElementById("usewaifu_labelb").style.color = "#FFFFFF";
}
}

function SettingOutput(){

var s = "\ ";

var form = document.SettingForm;

if ( form.usewaifu_autoswitch.checked ){
var usewaifu = "auto";
} else if ( form.usewaifu[0].checked ){
var usewaifu = "waifu2x-converter";
} else if ( form.usewaifu[1].checked ){
var usewaifu = "waifu2x-caffe-cui";
}
var scaleauto_width01 = form.scaleauto_width.value;
var scaleauto_height01 = form.scaleauto_height.value;
if ( form.scaleauto_check.checked ){

var scaleauto = "true";

if ( scaleauto_width01 == "" ){
var scaleauto_width01 = 0;
}
if ( scaleauto_height01 == "" ){
var scaleauto_height01 = 0;
}
if ( scaleauto_height01 == "0" && scaleauto_width01 == "0"  ) {
var scaleauto = "false";
}

} else {
var scaleauto = "false";
}

var scale_ratio01 = form.scale_ratio01.value;

if ( form.mode01[0].checked ){
var mode01 = "auto_scale";
} else if ( form.mode01[1].checked ){
var mode01 = "noise_scale";
} else if ( form.mode01[2].checked ){
var mode01 = "scale";
} else if ( form.mode01[3].checked ){
var mode01 = "noise";
}
var model01 = form.model01.value;
var inexlim;
for ( i=0; i < form.inexli01.length; i++ ){
if ( form.inexli01[i].checked ){
if ( inexlim == void 0 ){
var inexlim = form.inexli01[i].value + "\:";
} else {
var inexlim = inexlim + form.inexli01[i].value + "\:";
}
}
}
if ( inexlim == void 0 ){
var inexlim = "png\:jpg\:jpeg\:tif\:tiff\:bmp\:tga\:";
}
var inexli01 = inexlim.substr( 0 , inexlim.length - 1 );
var subf01 = form.subf01.checked;

var i = 0;
do {
var folderoutmodetf = form.folderoutmode[i].checked;
var folderoutmode = form.folderoutmode[i].value;
i++;
} while( folderoutmodetf == false );
var outfoldernameset = form.outfoldernameset.value;
var compformat = form.compformat.value;
var twittermode = form.twittermode.checked;
var alphaswitch = form.alphaswitch.checked;
var otheropca01 = '\"' + form.otheropca01.value.replace( / /g , "△" ) + '\"';
var otheropco01 = '\"' + form.otheropco01.value.replace( / /g , "△" ) + '\"';
var otheropsz01 = '\"' + form.otheropsz01.value.replace( / /g , "△" ) + '\"';
var otheropff01 = '\"' + form.otheropff01.value.replace( / /g , "△" ) + '\"';
if ( otheropca01 == "" ){
var otheropca01 = '\"' + "none" + '\"';
}
if ( otheropco01 == "" ){
var otheropco01 = '\"' + "none" + '\"';
}
if ( otheropsz01 == "" ){
var otheropsz01 = '\"' + "none" + '\"';
}
var noise_level01 = noiselevelhoge();
if ( form.alarm_switch.checked ){
if ( form.alarmfile.value == "" ){
var endwav = "none";
} else {
var endwav = '\"' + form.alarmfile.value.replace( /\ /g , "△" ) + '\"';
}
} else {
var endwav = "none";
}
if ( form.icc_switch.checked ){
if ( form.IccProf.value == "" ){
var IccProf = "none";
} else {
var IccProf = '\"' + form.IccProf.value.replace( /\ /g , "△" ) + '\"';
}
} else {
var IccProf = "none";
}
if ( form.extension_switch.checked ){
if ( form.OutputExtension.value == "" ){
var OutputExtension = "false";
} else {
var OutputExtension = form.OutputExtension.value;
}
} else {
var OutputExtension = "false";
}
var out = mode01 + s + model01 + s + scaleauto + s + scaleauto_width01 + s + scaleauto_height01 + s + scale_ratio01 + s + noise_level01 + s + inexli01 + s + subf01 + s + usewaifu + s + folderoutmode + s + outfoldernameset + s + compformat + s + endwav + s + twittermode + s + alphaswitch + s + OutputExtension + s + IccProf + s + otheropca01 + s + otheropco01 + s + otheropsz01 + s + otheropff01 + s + window.outerWidth + s + window.outerHeight + s + window.screenX + s + window.screenY + s;


// 参考→ http://sei.qee.jp/docs/program/hta/location/href.html


var fs = new ActiveXObject( "Scripting.FileSystemObject" );
var myCD        = fs.GetFolder(".").ShortPath;
var myBat       = myCD + "\\script\\waifu2x-front_end.bat";
var myBatShort  = fs.GetFile( myBat ).ShortPath;
var outsetting  = myCD + "\\script\\setting.ini";
var outsetShort = fs.GetFile( outsetting ).ShortPath;
//alert(myCD);
var f = fs.OpenTextFile( outsetting , 2 , true );
f.WriteLine( out );
f.Close();

}



window.onload = function() {
firstread();
FoldermodeChanging();
scaleautoChanging();
modeselect();
noiselevelrange();
folderable();
compressdisable();
w2xautochange();
alarmchange();
iccchange();
extechange();
windowresize();
}
window.onresize = function(){
windowresize();
}
window.onbeforeunload = function(){
SettingOutput();
}



function ddObj::OLEDragDrop(Data,e){ 

var s = "\ ";

SettingOutput();

var fs = new ActiveXObject( "Scripting.FileSystemObject" );
var myCD        = fs.GetFolder(".").ShortPath;
var myBat       = myCD + "\\script\\waifu2x-front_end.bat";
var myBatShort  = fs.GetFile( myBat ).ShortPath;
var outsetting  = myCD + "\\script\\setting.ini";
var outsetShort = fs.GetFile( outsetting ).ShortPath;
try{
var sysFolder   = fs.GetFolder( "C:\\Windows\\Sysnative" );
//alert(sysFolder);
}catch(e){
var sysFolder   = fs.GetFolder( "C:\\Windows\\System32" );
}
//Data.Files.;DDしたファイルの数 
//Data.Files.Item(n);n＝1〜でDDしたファイルのフルパス 
try{
var FileS  = '"' + fs.GetFile( Data.Files.Item(1) ).ShortPath + '"';
}catch(e){
var FileS  = '"' + fs.GetFolder( Data.Files.Item(1) ).ShortPath + '"';
}
//alert(FileShort);
var TheFiles   = FileS;
var e = "true";
var n = 2;
try{
while(e){
 try{
 var FileS  = '"' + fs.GetFile( Data.Files.Item(n) ).ShortPath + '"';
 }catch(e){
 var FileS  = '"' + fs.GetFolder( Data.Files.Item(n) ).ShortPath + '"';
 }
 var TheFiles   = TheFiles + ' ' + FileS ;
 n ++;
}
}catch(e){
var wsh = new ActiveXObject( "WScript.Shell" );
var execcommand = sysFolder + '\\cmd.exe \/C start ' + myBatShort + s + outsetShort + s + TheFiles;
wsh.Exec( execcommand );
//alert( execcommand );
}
}

--></script>

</body>
</html>
